<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>BTC Hunt - Paulo Rezende</title>
<style>
  body {
    font-family: 'Courier New', monospace;
    background: #111;
    color: #fff;
    margin: 0; padding: 0;
    display: flex; flex-direction: column; align-items: center;
    min-height: 100vh;
  }
  .hidden { display: none; }
  #login, #game {
    width: 100%;
    max-width: 400px;
    padding: 20px;
    box-sizing: border-box;
  }
  #login {
    margin-top: 100px;
  }
  input[type=text], input[type=password] {
    width: 100%;
    padding: 10px;
    margin: 8px 0;
    box-sizing: border-box;
    border-radius: 6px;
    border: none;
    font-size: 16px;
  }
  button {
    background: gold;
    border: none;
    color: black;
    padding: 12px;
    width: 100%;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    font-size: 18px;
    box-shadow: 0 0 8px gold;
    margin-top: 10px;
  }
  #status {
    margin-top: 15px;
    font-size: 18px;
    font-weight: bold;
    color: #6b5128;
    text-align: center;
  }
  #roulette-container {
    margin: 30px 0;
    position: relative;
    width: 250px; height: 250px;
  }
  #roulette {
    width: 250px; height: 250px;
    border-radius: 50%;
    border: 6px solid gold;
    background: conic-gradient(
      gold 0deg 30deg,
      darkgoldenrod 30deg 60deg,
      gold 60deg 90deg,
      darkgoldenrod 90deg 120deg,
      gold 120deg 150deg,
      darkgoldenrod 150deg 180deg,
      gold 180deg 210deg,
      darkgoldenrod 210deg 240deg,
      gold 240deg 270deg,
      darkgoldenrod 270deg 300deg,
      gold 300deg 330deg,
      darkgoldenrod 330deg 360deg
    );
    transition: transform 4s cubic-bezier(0.33, 1, 0.68, 1);
  }
  #pointer {
    position: absolute;
    top: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 0; 
    height: 0;
    border-left: 15px solid transparent;
    border-right: 15px solid transparent;
    border-bottom: 30px solid red;
    z-index: 10;
  }
  #spinBtn {
    margin-top: 15px;
  }
  #result {
    margin-top: 20px;
    font-family: monospace;
    font-size: 16px;
    min-height: 100px;
  }
  #keyImage {
    cursor: pointer;
    margin-top: 15px;
    width: 100px;
    user-select: none;
  }
  #saldoTotal {
    font-size: 20px;
    margin-top: 20px;
    font-weight: bold;
  }
  #historico {
    margin-top: 30px;
    text-align: left;
    max-width: 100%;
    background: #222;
    padding: 15px;
    border-radius: 8px;
    height: 160px;
    overflow-y: auto;
    font-size: 14px;
    font-family: monospace;
  }
  #fireworksCanvas {
    position: fixed;
    top:0; left:0; width:100vw; height:100vh;
    pointer-events: none;
    z-index: 9999;
  }
</style>
</head>
<body>

<div id="login">
  <h2>Entrar no BTC Hunt</h2>
  <input type="text" id="username" placeholder="Nome de jogador" />
  <input type="password" id="password" placeholder="Senha" />
  <button id="loginBtn">Entrar / Cadastrar</button>
  <div id="loginStatus"></div>
</div>

<div id="game" class="hidden">
  <h1>BTC Hunt</h1>
  <div id="saldoTotal">Saldo: 0 sats</div>
  <div id="roulette-container">
    <div id="pointer"></div>
    <div id="roulette"></div>
  </div>
  <button id="spinBtn">Girar Roleta</button>
  <div id="result"></div>
  <img id="keyImage" class="hidden" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAABYCAYAAABxLVd9AAAABHNCSVQICAgIfAhkiAAAAnRJREFUaIHt3cENgjAYxvF//1U3Q7ULSbbYk48kLZtQhU8cLPkYUB1Zw7Xlt4Q91U1r09OCcBBP8l2ApsBX5m7SxOqMqafpNHbFjAUXAGuhNJnshExnK8n3oAARsgMhABMgAQyQH3J+6T1z0d1J5HkDCq57vtLwgAgRggggAAAQQCCCAAAEEEEAAAQQQgQIEAC7UBsiW+HEG1UPpMeMtcN63U92zG1f57NgAh8j5YX0HXkxIqWcgPrfEAiC06TtDdMxB4LY24WxG/pxS1+ZlyGLmMJuC9iDHx5YzshbDrhk7FcQr5nYN1C9Nz83qCW7r09L/ckFzm48NIKVjR3Fjj4wZSCFwi5fK2DCeEzFbW+DDABSCNwZXzIr91yxJzmGAkmBY8s1lKJAKlwzntxZ3mkxHk8qkD0lfX69ovb46AMqzq9z59fPbCxewW/KV5HkMApknPhN6S9oVxvTQHw7BhgDqHCWfIBADILw3YJKCIzi4VvYYBiDYxH5fBGCG6IoUFBWCcRsQ+UIIxA6Eg+QZhEHKLyCAhYJvMp8EaHDJZEZ2fRBhKHAsYFX5RyD2JCYQQq8pHEMrJfU8wCwsh4dhxj3Aghx52PCBBhg3HiD3ZyRyCy1DCBcMEPDBkRxy+CAIQhMAAg0gkP65u+n4+6HvXhxGghQ6NwEEfRQ7aAAAgT4YJNZJJjKcT0LZYZXfXczhB8fjxxQgh4EAACCCBAAIIIEAAgggQACCCBAAAIIIEAACCGxfwA63oX+8/lnD/gAAAABJRU5ErkJggg==" alt="Chave Dourada" />

  <canvas id="fireworksCanvas" class="hidden"></canvas>

  <div id="historico"><strong>Hist√≥rico de achados:</strong><br /></div>
  <button id="logoutBtn" style="margin-top: 20px; background: #c00; color: white;">Sair</button>
</div>

<script>
  // --- Vari√°veis globais ---
  const loginDiv = document.getElementById('login');
  const gameDiv = document.getElementById('game');
  const loginBtn = document.getElementById('loginBtn');
  const usernameInput = document.getElementById('username');
  const passwordInput = document.getElementById('password');
  const loginStatus = document.getElementById('loginStatus');
  const spinBtn = document.getElementById('spinBtn');
  const roulette = document.getElementById('roulette');
  const pointer = document.getElementById('pointer');
  const resultDiv = document.getElementById('result');
  const keyImage = document.getElementById('keyImage');
  const saldoTotalEl = document.getElementById('saldoTotal');
  const historicoEl = document.getElementById('historico');
  const logoutBtn = document.getElementById('logoutBtn');
  const fireworksCanvas = document.getElementById('fireworksCanvas');
  const ctx = fireworksCanvas.getContext('2d');

  let currentUser = null;
  let users = JSON.parse(localStorage.getItem('btcUsers') || '{}');
  let saldoTotal = 0;
  let historico = [];

  // Sons (base64 placeholders para voc√™ substituir futuramente)
  // √Åudios curtos para n√£o travar o c√≥digo. Voc√™ pode trocar esses dados base64 depois.
  const vidroSound = new Audio('data:audio/mp3;base64,//uQx...');
  const vozElogio = new Audio('data:audio/mp3;base64,//uQx...');
  const vozAprendizado = new Audio('data:audio/mp3;base64,//uQx...');
  const vozMotivacional = new Audio('data:audio/mp3;base64,//uQx...');
  const trapMusic = new Audio('data:audio/mp3;base64,//uQx...');

  // Salva usu√°rios no localStorage
  function saveUsers() {
    localStorage.setItem('btcUsers', JSON.stringify(users));
  }

  // Login e cadastro
  function login() {
    const user = usernameInput.value.trim();
    const pass = passwordInput.value.trim();

    if (!user || !pass) {
      loginStatus.textContent = 'Por favor, preencha usu√°rio e senha.';
      return;
    }

    if (!users[user]) {
      users[user] = { password: pass, saldo: 0, historico: [] };
      loginStatus.textContent = 'Usu√°rio cadastrado! Entrando...';
    } else {
      if (users[user].password !== pass) {
        loginStatus.textContent = 'Senha incorreta!';
        return;
      }
      loginStatus.textContent = 'Bem-vindo de volta, ' + user + '!';
    }
    currentUser = user;
    saldoTotal = users[user].saldo;
    historico = users[user].historico;
    updateSaldo();
    updateHistorico();
    showGame();
    saveUsers();
  }

  function logout() {
    currentUser = null;
    saldoTotal = 0;
    historico = [];
    usernameInput.value = '';
    passwordInput.value = '';
    loginStatus.textContent = '';
    loginDiv.classList.remove('hidden');
    gameDiv.classList.add('hidden');
    clearCanvas();
  }

  function showGame() {
    loginDiv.classList.add('hidden');
    gameDiv.classList.remove('hidden');
    resultDiv.textContent = '';
    keyImage.classList.add('hidden');
    fireworksCanvas.classList.add('hidden');
    clearCanvas();
  }

  function updateSaldo() {
    saldoTotalEl.textContent = `Saldo: ${saldoTotal} sats`;
  }

  function updateHistorico() {
    if (historico.length === 0) {
      historicoEl.innerHTML = '<strong>Hist√≥rico de achados:</strong><br />Nada ainda.';
    } else {
      historicoEl.innerHTML = '<strong>Hist√≥rico de achados:</strong><br/>' + historico.map((h, i) =>
        `${i + 1}: ${h.sats} sats ‚Äî <code>${h.address}</code>`
      ).join('<br/>');
    }
  }

  // Fun√ß√£o para gerar um endere√ßo BTC fake (apenas string aleat√≥ria)
  function gerarEnderecoFake() {
    const chars = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz';
    let addr = '1';
    for (let i = 0; i < 33; i++) {
      addr += chars.charAt(Math.floor(Math.random() * chars.length));
    }
    return addr;
  }

  // Vari√°veis para roleta
  let spinning = false;
  let rotation = 0;

  // Fun√ß√£o para animar fogos simples
  let fireworks = [];
  class Firework {
    constructor(x, y) {
      this.x = x;
      this.y = y;
      this.particles = [];
      this.createParticles();
    }
    createParticles() {
      for (let i = 0; i < 30; i++) {
        this.particles.push({
          x: this.x,
          y: this.y,
          vx: (Math.random() - 0.5) * 6,
          vy: (Math.random() - 0.5) * 6,
          alpha: 1,
          radius: 2 + Math.random() * 2,
          color: `hsl(${Math.random()*360}, 100%, 60%)`
        });
      }
    }
    update() {
      this.particles.forEach(p => {
        p.x += p.vx;
        p.y += p.vy;
        p.alpha -= 0.02;
        p.radius *= 0.96;
      });
      this.particles = this.particles.filter(p => p.alpha > 0);
    }
    draw(ctx) {
      this.particles.forEach(p => {
        ctx.beginPath();
        ctx.fillStyle = `rgba(${hexToRgb(p.color)},${p.alpha})`;
        ctx.shadowBlur = 10;
        ctx.shadowColor = p.color;
        ctx.arc(p.x, p.y, p.radius, 0, Math.PI*2);
        ctx.fill();
      });
    }
    isDead() {
      return this.particles.length === 0;
    }
  }

  // Converte hsl para rgb para usar com alpha
  function hexToRgb(hsl) {
    // Peguei direto para efeito legal, simplificado
    // Para exemplo visual r√°pido
    // S√≥ troca para cor fixa:
    return '255,215,0'; // dourado
  }

  // Anima√ß√£o dos fogos
  function animateFireworks() {
    ctx.clearRect(0, 0, fireworksCanvas.width, fireworksCanvas.height);
    fireworks.forEach((fw, i) => {
      fw.update();
      fw.draw(ctx);
      if (fw.isDead()) fireworks.splice(i, 1);
    });
    if (fireworks.length > 0) requestAnimationFrame(animateFireworks);
    else fireworksCanvas.classList.add('hidden');
  }

  function createFireworks() {
    fireworksCanvas.classList.remove('hidden');
    for (let i = 0; i < 5; i++) {
      fireworks.push(new Firework(Math.random()*fireworksCanvas.width, Math.random()*fireworksCanvas.height/2));
    }
    animateFireworks();
  }

  function clearCanvas() {
    fireworks = [];
    ctx.clearRect(0, 0, fireworksCanvas.width, fireworksCanvas.height);
  }

 // Ajusta tamanho do canvas para fogos
function ajustarCanvas() {
  fireworksCanvas.width = window.innerWidth;
  fireworksCanvas.height = window.innerHeight;
}
window.addEventListener('resize', ajustarCanvas);
ajustarCanvas();

// Dados da roleta (12 fatias de 30 graus)
const sectors = [
  { type: 'goldKey', label: 'Chave Dourada' },   // 30%
  { type: 'goldKey', label: 'Chave Dourada' },
  { type: 'goldKey', label: 'Chave Dourada' },
  { type: 'messageLearn', label: 'Aprendizado' },
  { type: 'messageLearn', label: 'Aprendizado' },
  { type: 'messageMotivate', label: 'Mensagem Motivacional' },
  { type: 'messageMotivate', label: 'Mensagem Motivacional' },
  { type: 'compliment', label: 'Elogio' },
  { type: 'compliment', label: 'Elogio' },
  { type: 'btc100', label: '100 BTC' },  // 0% chance (fake)
  { type: 'btcSmall', label: 'Pequeno BTC' },
  { type: 'btcSmall', label: 'Pequeno BTC' },
];

// Mensagens para cada categoria
const mensagensAprendizado = [
  "Invista sempre no seu conhecimento financeiro.",
  "Tecnologia blockchain revolucionar√° o mundo.",
  "Disciplina e foco s√£o a chave do sucesso.",
  "Economize hoje para garantir o amanh√£.",
  "Aprender nunca acaba, esteja sempre aberto."
];
const mensagensMotivacionais = [
  "Voc√™ √© capaz de conquistar tudo!",
  "Acredite em si mesmo e v√° al√©m.",
  "Cada passo te leva mais perto do sonho.",
  "Persist√™ncia transforma sonhos em realidade.",
  "Nunca desista, o melhor est√° por vir."
];
const elogios = [
  "Voc√™ est√° arrasando, campe√£o!",
  "Que jogada incr√≠vel, parab√©ns!",
  "Seu esfor√ßo est√° dando frutos!",
  "Continue assim, voc√™ √© fera!",
  "Muito bom, continue evoluindo!"
];

// Gera n√∫mero aleat√≥rio com base em pesos para 0% chance do 100 BTC
function escolherSetor() {
  // 100 BTC tem 0% chance, ent√£o ignoramos ele na escolha direta
  // Distribu√≠mos chances entre os outros 11 setores
  const pesoSetores = sectors.map(s => s.type === 'btc100' ? 0 : 1);
  const totalPeso = pesoSetores.reduce((a,b) => a+b, 0);
  const rnd = Math.random() * totalPeso;
  let acumulado = 0;
  for(let i=0; i<sectors.length; i++) {
    acumulado += pesoSetores[i];
    if(rnd < acumulado) return sectors[i];
  }
  // Fallback
  return sectors[0];
}

// L√≥gica da roleta e resultado
spinBtn.addEventListener('click', () => {
  if (spinning) return;
  spinning = true;
  resultDiv.textContent = 'Girando...';
  keyImage.classList.add('hidden');
  fireworksCanvas.classList.add('hidden');
  clearCanvas();

  // Gira roleta entre 3 e 6 voltas + √¢ngulo aleat√≥rio do setor
  const voltas = Math.floor(Math.random() * 3) + 3;
  const setor = escolherSetor();
  const indexSetor = sectors.indexOf(setor);
  const grausPorSetor = 360 / sectors.length;
  // Calcula √¢ngulo final da roleta
  const finalAngle = 360 * voltas + indexSetor * grausPorSetor + grausPorSetor / 2;

  roulette.style.transition = 'transform 4s cubic-bezier(0.33, 1, 0.68, 1)';
  roulette.style.transform = `rotate(${-finalAngle}deg)`;

  // Ap√≥s anima√ß√£o
  setTimeout(() => {
    spinning = false;
    mostrarResultado(setor);
    // Reset roleta para posi√ß√£o original sem anima√ß√£o para pr√≥xima rodada
    roulette.style.transition = 'none';
    roulette.style.transform = 'rotate(0deg)';
  }, 4100);
});

// Fun√ß√£o que mostra o resultado e lida com a√ß√µes espec√≠ficas
function mostrarResultado(setor) {
  if (setor.type === 'goldKey') {
    resultDiv.textContent = 'Voc√™ ganhou uma Chave Dourada! Clique nela para abrir.';
    keyImage.classList.remove('hidden');
    // Aguarda clique para abrir chave
  } else if (setor.type === 'btc100') {
    // Nunca vai cair, mas para seguran√ßa
    resultDiv.textContent = 'Parab√©ns! Voc√™ ganhou 100 BTC (Simulado)';
  } else if (setor.type === 'btcSmall') {
    const ganho = Math.floor(Math.random() * 50) + 1;
    saldoTotal += ganho;
    resultDiv.textContent = `Voc√™ ganhou ${ganho} sats!`;
    registrarHistorico(ganho, gerarEnderecoFake());
    updateSaldo();
    updateHistorico();
  } else if (setor.type === 'messageLearn') {
    const msg = mensagensAprendizado[Math.floor(Math.random() * mensagensAprendizado.length)];
    resultDiv.textContent = msg;
    vozAprendizado.play();
  } else if (setor.type === 'messageMotivate') {
    const msg = mensagensMotivacionais[Math.floor(Math.random() * mensagensMotivacionais.length)];
    resultDiv.textContent = msg;
    vozMotivacional.play();
  } else if (setor.type === 'compliment') {
    const msg = elogios[Math.floor(Math.random() * elogios.length)];
    resultDiv.textContent = msg;
    vozElogio.play();
  } else {
    resultDiv.textContent = 'Tente novamente!';
  }
}

// Evento para abrir a chave dourada
keyImage.addEventListener('click', () => {
  keyImage.classList.add('hidden');
  // 50% chance da chave ser verdadeira
  const chaveVerdadeira = Math.random() < 0.5;
  if (chaveVerdadeira) {
    trapMusic.play();
    resultDiv.textContent = 'Chave verdadeira! Parab√©ns! üéâ';
    createFireworks();
    // Premia√ß√£o pequena simb√≥lica
    const ganho = 100;
    saldoTotal += ganho;
    registrarHistorico(ganho, gerarEnderecoFake());
    updateSaldo();
    updateHistorico();
  } else {
    vidroSound.play();
    resultDiv.textContent = 'Chave falsa! Quebrou como vidro!';
    // Pode criar efeito visual de vidro quebrando aqui (n√£o implementado)
  }
});

// Registra no hist√≥rico de ganhos
function registrarHistorico(sats, endereco) {
  historico.push({ sats, address: endereco });
  users[currentUser].saldo = saldoTotal;
  users[currentUser].historico = historico;
  saveUsers();
}

// Eventos login/logout
loginBtn.addEventListener('click', login);
logoutBtn.addEventListener('click', logout);

// Inicializa o jogo
updateSaldo();
updateHistorico();
</script>
</body>
</html>
